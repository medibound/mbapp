{"version":3,"sources":["BottomSheetBackdrop.tsx"],"names":["interpolate","interpolateV1","interpolateNode","interpolateV2","require","AnimatedTouchableWithoutFeedback","Animated","createAnimatedComponent","TouchableWithoutFeedback","BottomSheetBackdropComponent","animatedIndex","animatedPosition","opacity","DEFAULT_OPACITY","appearsOnIndex","DEFAULT_APPEARS_ON_INDEX","disappearsOnIndex","DEFAULT_DISAPPEARS_ON_INDEX","enableTouchThrough","DEFAULT_ENABLE_TOUCH_THROUGH","pressBehavior","closeOnPress","style","accessible","_providedAccessible","DEFAULT_ACCESSIBLE","accessibilityRole","_providedAccessibilityRole","DEFAULT_ACCESSIBILITY_ROLE","accessibilityLabel","_providedAccessibilityLabel","DEFAULT_ACCESSIBILITY_LABEL","accessibilityHint","_providedAccessibilityHint","DEFAULT_ACCESSIBILITY_HINT","rest","handleOnPress","syntheticPressBehavior","containerRef","pointerEvents","isTouchable","animatedOpacity","inputRange","outputRange","extrapolate","Extrapolate","CLAMP","buttonStyle","transform","translateY","WINDOW_HEIGHT","containerStyle","styles","container","setPointerEvents","value","current","setNativeProps","undefined","BottomSheetBackdrop","isEqual"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useMemo, useRef } from 'react';\nimport { View, TouchableWithoutFeedback } from 'react-native';\nimport Animated, {\n  and,\n  block,\n  call,\n  cond,\n  eq,\n  Extrapolate,\n  neq,\n  not,\n  set,\n  useCode,\n} from 'react-native-reanimated';\nimport isEqual from 'lodash.isequal';\nimport { useReactiveValue } from '../../hooks';\nimport {\n  DEFAULT_OPACITY,\n  DEFAULT_APPEARS_ON_INDEX,\n  DEFAULT_DISAPPEARS_ON_INDEX,\n  DEFAULT_ENABLE_TOUCH_THROUGH,\n  DEFAULT_ACCESSIBLE,\n  DEFAULT_ACCESSIBILITY_ROLE,\n  DEFAULT_ACCESSIBILITY_LABEL,\n  DEFAULT_ACCESSIBILITY_HINT,\n} from './constants';\nimport { WINDOW_HEIGHT } from '../../constants';\nimport { usePressBehavior } from './usePressBehavior';\nimport { styles } from './styles';\nimport type { BottomSheetDefaultBackdropProps } from './types';\n\nconst {\n  interpolate: interpolateV1,\n  interpolateNode: interpolateV2,\n} = require('react-native-reanimated');\nconst interpolate = interpolateV2 || interpolateV1;\n\nconst AnimatedTouchableWithoutFeedback = Animated.createAnimatedComponent(\n  TouchableWithoutFeedback\n);\n\nconst BottomSheetBackdropComponent = ({\n  animatedIndex,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  animatedPosition,\n  opacity = DEFAULT_OPACITY,\n  appearsOnIndex = DEFAULT_APPEARS_ON_INDEX,\n  disappearsOnIndex = DEFAULT_DISAPPEARS_ON_INDEX,\n  enableTouchThrough = DEFAULT_ENABLE_TOUCH_THROUGH,\n  pressBehavior,\n  closeOnPress,\n  style,\n  accessible: _providedAccessible = DEFAULT_ACCESSIBLE,\n  accessibilityRole: _providedAccessibilityRole = DEFAULT_ACCESSIBILITY_ROLE,\n  accessibilityLabel: _providedAccessibilityLabel = DEFAULT_ACCESSIBILITY_LABEL,\n  accessibilityHint: _providedAccessibilityHint = DEFAULT_ACCESSIBILITY_HINT,\n  ...rest\n}: BottomSheetDefaultBackdropProps) => {\n  //#region hooks\n  const { handleOnPress, syntheticPressBehavior } = usePressBehavior({\n    pressBehavior,\n    closeOnPress,\n    disappearsOnIndex,\n  });\n  //#endregion\n\n  //#region variables\n  const containerRef = useRef<Animated.View>(null);\n  const pointerEvents = useMemo(() => (enableTouchThrough ? 'none' : 'auto'), [\n    enableTouchThrough,\n  ]);\n  //#endregion\n\n  //#region animation variables\n  const isTouchable = useReactiveValue(\n    syntheticPressBehavior !== 'none' ? 1 : 0\n  );\n  const animatedOpacity = useMemo(\n    () =>\n      interpolate(animatedIndex, {\n        inputRange: [disappearsOnIndex, appearsOnIndex],\n        outputRange: [0, opacity],\n        extrapolate: Extrapolate.CLAMP,\n      }),\n    [animatedIndex, opacity, appearsOnIndex, disappearsOnIndex]\n  );\n  //#endregion\n\n  //#region styles\n  const buttonStyle = useMemo(\n    () => [\n      style,\n      {\n        transform: [\n          {\n            translateY: cond(\n              eq(animatedIndex, disappearsOnIndex),\n              WINDOW_HEIGHT,\n              0\n            ),\n          },\n        ],\n      },\n    ],\n    [disappearsOnIndex, style, animatedIndex]\n  );\n  const containerStyle = useMemo(\n    () => [\n      styles.container,\n      style,\n      {\n        opacity: animatedOpacity,\n      },\n    ],\n    [style, animatedOpacity]\n  );\n  //#endregion\n\n  const setPointerEvents = useCallback((value: string) => {\n    if (containerRef.current) {\n      ((containerRef.current as any) as View).setNativeProps({\n        pointerEvents: value,\n      });\n    }\n  }, []);\n\n  //#region effects\n  useCode(\n    () =>\n      block([\n        cond(\n          and(eq(animatedIndex, disappearsOnIndex), isTouchable),\n          [set(isTouchable, 0), call([], () => setPointerEvents('none'))],\n          cond(and(neq(animatedIndex, disappearsOnIndex), not(isTouchable)), [\n            set(isTouchable, 1),\n            call([], () => setPointerEvents('auto')),\n          ])\n        ),\n      ]),\n    [animatedIndex, disappearsOnIndex, isTouchable, setPointerEvents]\n  );\n  //#endregion\n\n  return syntheticPressBehavior !== 'none' ? (\n    <AnimatedTouchableWithoutFeedback\n      accessible={_providedAccessible ?? undefined}\n      accessibilityRole={_providedAccessibilityRole ?? undefined}\n      accessibilityLabel={_providedAccessibilityLabel ?? undefined}\n      accessibilityHint={_providedAccessibilityHint ?? undefined}\n      style={buttonStyle}\n      onPress={handleOnPress}\n      {...rest}\n    >\n      <Animated.View ref={containerRef} key=\"backdrop\" style={containerStyle} />\n    </AnimatedTouchableWithoutFeedback>\n  ) : (\n    <Animated.View\n      ref={containerRef}\n      key=\"backdrop\"\n      accessible={_providedAccessible ?? undefined}\n      accessibilityRole={_providedAccessibilityRole ?? undefined}\n      accessibilityLabel={_providedAccessibilityLabel ?? undefined}\n      accessibilityHint={_providedAccessibilityHint ?? undefined}\n      pointerEvents={pointerEvents}\n      style={containerStyle}\n      {...rest}\n    />\n  );\n};\n\nconst BottomSheetBackdrop = memo(BottomSheetBackdropComponent, isEqual);\n\nexport default BottomSheetBackdrop;\n"]}